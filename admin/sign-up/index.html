<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/CEU-Logo.png">
  <link rel="icon" type="image/png" href="../assets/img/CEU-Logo.png">
  <title>
    CEU VAULT | Sign-up
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
  <!-- Nucleo Icons -->
  <link href="../assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="../assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <link href="../assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link id="pagestyle" href="../assets/css/soft-ui-dashboard.css" rel="stylesheet" />
  <!-- Nepcha Analytics (nepcha.com) -->
  <!-- Nepcha is a easy-to-use web analytics. No cookies and fully compliant with GDPR, CCPA and PECR. -->
  <script defer data-site="YOUR_DOMAIN_HERE" src="https://api.nepcha.com/js/nepcha-analytics.js"></script>

  <style>
    /* Update alert styles for more subtle appearance */
    .alert {
      background-color: #ffffff;
      border-radius: 1rem;
      box-shadow: 0 20px 27px 0 rgba(0, 0, 0, 0.05);
      border: 0;
      padding: 1rem;
      transition: all 0.3s ease-in-out;
      opacity: 1;
      transform: translateY(0);
    }

    .alert-success {
      color: #344767;
      /* Soft UI's default text color */
      border-left: 3px solid #82d616;
      /* More subtle green */
      background: linear-gradient(to right, rgba(130, 214, 22, 0.05), transparent);
    }

    .alert-danger {
      color: #344767;
      border-left: 3px solid #ea0606;
      /* More subtle red */
      background: linear-gradient(to right, rgba(234, 6, 6, 0.05), transparent);
    }

    .alert.fade {
      transition: all 0.3s ease-in-out;
      opacity: 0;
      transform: translateY(-10px);
    }

    .alert.fade.show {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
  <style>
    /* Loading overlay styles */
    .loading-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      justify-content: center;
      align-items: center;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>


  <!-- Add this style block to the head section -->
  <style>
    .input-group {
      display: flex;
      position: relative;
    }

    .input-group .form-control {
      border-right: 0;
      border-top-right-radius: 0 !important;
      border-bottom-right-radius: 0 !important;
      height: 41px;
      /* Set explicit height */
    }

    .input-group .btn-outline-secondary {
      margin-left: -1px;
      border: 1px solid #d2d6da;
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
      padding: 0.625rem 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 4;
      height: 41px;
      /* Match form-control height */
      line-height: 1.5;
    }

    .input-group .form-control:focus {
      z-index: 3;
    }

    .input-group .form-control:focus+.btn-outline-secondary {
      border-color: #e293d3;
      border-left-color: #e293d3;
    }

    .input-group .btn-outline-secondary:hover {
      background-color: transparent;
      color: #67748e;
      border-color: #d2d6da;
    }
  </style>

  <!-- Add JavaScript to control visibility -->
  <script>
    const passwordInput = document.getElementById('adminPassword');
    const requirements = document.getElementById('passwordRequirements');

    passwordInput.addEventListener('focus', () => {
      requirements.style.display = 'block';
    });

    passwordInput.addEventListener('input', () => {
      requirements.style.display = 'block';
    });

    passwordInput.addEventListener('blur', () => {
      if (!passwordInput.value) {
        requirements.style.display = 'none';
      }
    });
  </script>

  <style>
    #passwordRequirements {
      display: none;
      transition: all 0.3s ease;
    }
  </style>

  <script>
    // Add this to your existing JavaScript
    document.addEventListener('DOMContentLoaded', () => {
      const termsCheck = document.getElementById('termsCheck');

      // Set initial validation message
      termsCheck.setCustomValidity('Please accept the Terms and Conditions to proceed');

      // Update validation message based on checkbox state
      termsCheck.addEventListener('change', function () {
        if (this.checked) {
          this.setCustomValidity(''); // Clear validation message when checked
        } else {
          this.setCustomValidity('Please accept the Terms and Conditions to proceed');
        }
      });
    });
  </script>

  <style>
    /* Add these styles */
    .alert.fade {
      transition: all 0.3s ease-in-out;
      opacity: 0;
      transform: translateY(-10px);
    }

    .alert.fade.show {
      opacity: 1;
      transform: translateY(0);
    }
  </style>

</head>

<body class="">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg position-absolute top-0 z-index-3 w-100 shadow-none my-3 navbar-transparent mt-4">
    <div class="container">
      <a class="navbar-brand font-weight-bolder ms-lg-0 ms-3 text-white" href="../sign-in/">
        CEU VAULT Administrator
      </a>
      <button class="navbar-toggler shadow-none ms-2" type="button" data-bs-toggle="collapse"
        data-bs-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon mt-2">
          <span class="navbar-toggler-bar bar1"></span>
          <span class="navbar-toggler-bar bar2"></span>
          <span class="navbar-toggler-bar bar3"></span>
        </span>
      </button>
      <div class="collapse navbar-collapse" id="navigation">
        <ul class="navbar-nav mx-auto ms-xl-auto me-xl-7">
          <li class="nav-item">
            <a class="nav-link d-flex align-items-center me-2 active" aria-current="page" href="../home-page/">
              <i class="fa fa-chart-pie opacity-6  me-1"></i>
              Dashboard
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link me-2" href="../profile/">
              <i class="fa fa-user opacity-6  me-1"></i>
              Profile
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link me-2" href="../sign-up/">
              <i class="fas fa-user-circle opacity-6  me-1"></i>
              Sign Up
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link me-2" href="../sign-in/">
              <i class="fas fa-key opacity-6  me-1"></i>
              Sign In
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- End Navbar -->
  <main class="main-content  mt-0">
    <section class="min-vh-100 mb-8">
      <div class="page-header align-items-start min-vh-50 pt-5 pb-11 m-3 border-radius-lg"
        style="background-image: url('../assets/img/curved-images/curved14.jpg');">
        <span class="mask bg-gradient-dark opacity-6"></span>
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-lg-5 text-center mx-auto">
              <h1 class="text-white mb-2 mt-5">WELCOME!</h1>
              <p class="text-lead text-white">Note that account registration or signing-up will require admin approval.
                Expect registration approval within 24 hours after signing-up.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="row mt-lg-n10 mt-md-n11 mt-n10">
          <div class="col-xl-4 col-lg-5 col-md-7 mx-auto">
            <div class="card z-index-0">

              <div class="card-header text-center pt-4">
                <h4>Register</h4>
              </div>

              <!-- 
              <div class="row px-xl-5 px-sm-4 px-3 d-flex justify-content-center">
                <div class="col-3 px-1">
                  <a class="btn btn-outline-light w-100" href="javascript:;">
                    <svg width="24px" height="32px" viewBox="0 0 64 64" version="1.1" xmlns="http://www.w3.org/2000/svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink">
                      <g id="Artboard" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <g id="google-icon" transform="translate(3.000000, 2.000000)" fill-rule="nonzero">
                          <path
                            d="M57.8123233,30.1515267 C57.8123233,27.7263183 57.6155321,25.9565533 57.1896408,24.1212666 L29.4960833,24.1212666 L29.4960833,35.0674653 L45.7515771,35.0674653 C45.4239683,37.7877475 43.6542033,41.8844383 39.7213169,44.6372555 L39.6661883,45.0037254 L48.4223791,51.7870338 L49.0290201,51.8475849 C54.6004021,46.7020943 57.8123233,39.1313952 57.8123233,30.1515267"
                            id="Path" fill="#4285F4"></path>
                          <path
                            d="M29.4960833,58.9921667 C37.4599129,58.9921667 44.1456164,56.3701671 49.0290201,51.8475849 L39.7213169,44.6372555 C37.2305867,46.3742596 33.887622,47.5868638 29.4960833,47.5868638 C21.6960582,47.5868638 15.0758763,42.4415991 12.7159637,35.3297782 L12.3700541,35.3591501 L3.26524241,42.4054492 L3.14617358,42.736447 C7.9965904,52.3717589 17.959737,58.9921667 29.4960833,58.9921667"
                            id="Path" fill="#34A853"></path>
                          <path
                            d="M12.7159637,35.3297782 C12.0932812,33.4944915 11.7329116,31.5279353 11.7329116,29.4960833 C11.7329116,27.4640054 12.0932812,25.4976752 12.6832029,23.6623884 L12.6667095,23.2715173 L3.44779955,16.1120237 L3.14617358,16.2554937 C1.14708246,20.2539019 0,24.7439491 0,29.4960833 C0,34.2482175 1.14708246,38.7380388 3.14617358,42.736447 L12.7159637,35.3297782"
                            id="Path" fill="#FBBC05"></path>
                          <path
                            d="M29.4960833,11.4050769 C35.0347044,11.4050769 38.7707997,13.7975244 40.9011602,15.7968415 L49.2255853,7.66898166 C44.1130815,2.91684746 37.4599129,0 29.4960833,0 C17.959737,0 7.9965904,6.62018183 3.14617358,16.2554937 L12.6832029,23.6623884 C15.0758763,16.5505675 21.6960582,11.4050769 29.4960833,11.4050769"
                            id="Path" fill="#EB4335"></path>
                        </g>
                      </g>
                    </svg>
                  </a>
                </div>
              </div>
             
              <div class="mt-2 position-relative text-center">
                <p class="text-sm font-weight-bold mb-2 text-secondary text-border d-inline z-index-2 bg-white px-3">
                  or
                </p>
              </div>
              -->
              <div class="card-body">
                <form id="adminSignupForm" role="form text-left">
                  <div class="mb-3">
                    <input type="text" id="adminName" class="form-control" placeholder="Name" aria-label="Name"
                      required>
                  </div>
                  <div class="mb-3">
                    <input type="email" id="adminEmail" class="form-control" placeholder="Email" aria-label="Email"
                      pattern="[a-zA-Z0-9._%+-]+@(ceu\.edu\.ph|mls\.ceu\.edu\.ph)$"
                      title="Please use your CEU email address (@ceu.edu.ph or @mls.ceu.edu.ph)" required>
                    <div class="invalid-feedback">
                      Please enter a valid CEU email address (@ceu.edu.ph or @mls.ceu.edu.ph)
                    </div>
                  </div>
                  <!-- Update the password input div -->
                  <div class="mb-3">
                    <div class="input-group">
                      <input type="password" id="adminPassword" class="form-control" placeholder="Password"
                        aria-label="Password"
                        pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,24}$" required
                        oninput="validatePassword(this)" minlength="8" maxlength="24">
                      <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                        <i class="far fa-eye"></i>
                      </button>
                    </div>

                    <div id="passwordRequirements" class="mt-2 small text-muted">
                      <p class="mb-1">Password must contain:</p>
                      <ul class="ps-3 mb-0">
                        <li id="minLength">Between 8-24 characters</li>
                        <li id="hasUpper">At least one uppercase letter</li>
                        <li id="hasLower">At least one lowercase letter</li>
                        <li id="hasNumber">At least one number</li>
                        <li id="hasSpecial">At least one special character (@$!%*?&)</li>
                      </ul>
                    </div>
                  </div>

                  <div class="form-check form-check-info text-left">
                    <input class="form-check-input" type="checkbox" id="termsCheck" required>
                    <label class="form-check-label" for="termsCheck">
                      I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal"
                        class="text-dark font-weight-bolder">Terms and Conditions</a>
                    </label>
                  </div>

                  <div class="text-center">
                    <button type="submit" class="btn bg-gradient-dark w-100 my-4 mb-2">Sign up</button>
                  </div>
                </form>

                <div id="loadingOverlay" class="loading-overlay">
                  <div class="spinner"></div>
                </div>

              </div>
            </div>

            <div id="messageArea" class="alert mt-3 fade show shadow-sm" role="alert" style="display: none;">
              <!-- Message content will be injected here -->
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- -------- START FOOTER 3 w/ COMPANY DESCRIPTION WITH LINKS & SOCIAL ICONS & COPYRIGHT ------- -->
    <footer class="footer py-5">
      <div class="container">
        <div class="row">
          <div class="col-8 mx-auto text-center mt-1">
            <p class="mb-0 text-secondary">
              Copyright ©
              <script>
                document.write(new Date().getFullYear())
              </script> <strong>CEU VAULT</strong> for TLTS, CEU Malolos. All rights reserved.
            </p>
          </div>
        </div>
      </div>
    </footer>
    <!-- -------- END FOOTER 3 w/ COMPANY DESCRIPTION WITH LINKS & SOCIAL ICONS & COPYRIGHT ------- -->
  </main>
  <!--   Core JS Files   -->
  <script src="../assets/js/core/popper.min.js"></script>
  <script src="../assets/js/core/bootstrap.min.js"></script>
  <script src="../assets/js/plugins/perfect-scrollbar.min.js"></script>
  <script src="../assets/js/plugins/smooth-scrollbar.min.js"></script>
  <script>
    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
      var options = {
        damping: '0.5'
      }
      Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
  </script>
  <!-- Github buttons -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <!-- Control Center for Soft Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../assets/js/soft-ui-dashboard.min.js?v=1.0.7"></script>
  <!-- Terms and Conditions Modal -->
  <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="termsModalLabel">Terms and Conditions</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <h3>ACCEPTANCE OF TERMS</h3>
          <p>By accessing and using the CEU VAULT Administrator system, you agree to be bound by these Terms and
            Conditions.</p>

          <h6>1. User Responsibilities</h6>
          <p>As an administrator, you are responsible for:</p>
          <ul>
            <li>Maintaining the confidentiality of your account credentials</li>
            <li>All activities that occur under your account</li>
            <li>Ensuring the accuracy of information entered into the system</li>
            <li>Complying with all applicable laws and regulations</li>
          </ul>

          <h6>2. Privacy and Data Protection</h6>
          <p>You agree to:</p>
          <ul>
            <li>Handle user data with confidentiality</li>
            <li>Use personal information only for authorized purposes</li>
            <li>Comply with data protection regulations</li>
          </ul>

          <h6>3. System Access and Security</h6>
          <p>You must:</p>
          <ul>
            <li>Use secure passwords</li>
            <li>Log out after each session</li>
            <li>Report any security concerns immediately</li>
          </ul>

          <h6>4. Account Creation</h6>
          <p>Upon registration, please expect:</p>
          <ul>
            <li>That the request for account creation will require admin approval</li>
            <li>Admin approval should only last within 24 hours.</li>
            <li>Contact your IT Administrator or the TLTS Staff should you have any concern.</li>
          </ul>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn bg-gradient-primary" id="acceptTerms">Accept Terms</button>
        </div>
      </div>
    </div>
  </div>

</body>
<script>
  document.getElementById('adminSignupForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const submitButton = e.target.querySelector('button[type="submit"]');
    const loadingOverlay = document.getElementById('loadingOverlay');

    // Get form values
    const name = document.getElementById('adminName').value;
    const email = document.getElementById('adminEmail').value;
    const password = document.getElementById('adminPassword').value;
    const termsCheck = document.getElementById('termsCheck').checked;
    const messageArea = document.getElementById('messageArea');

    if (!termsCheck) {
      showMessage('Please accept the terms and conditions', 'error');
      return;
    }

    try {
      // Show loading overlay and disable submit button
      loadingOverlay.style.display = 'flex';
      submitButton.disabled = true;
      submitButton.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Signing up...';

      const response = await fetch('/admin/create-admin', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ name, email, password })
      });

      const data = await response.json();

      if (response.ok) {
        showMessage(data.message, 'success');
        document.getElementById('adminSignupForm').reset();
      } else {
        showMessage(data.message, 'error');
      }
    } catch (error) {
      showMessage('An error occurred. Please try again later.', 'error');
    } finally {
      // Hide loading overlay and restore submit button
      loadingOverlay.style.display = 'none';
      submitButton.disabled = false;
      submitButton.innerHTML = 'Sign up';
    }
  });

  // Single showMessage function - place this in one script block
  function showMessage(message, type) {
    const messageArea = document.getElementById('messageArea');
    messageArea.textContent = message;
    messageArea.className = `alert mt-3 fade shadow-sm alert-${type === 'success' ? 'success' : 'danger'}`;
    messageArea.style.display = 'block';

    // Force reflow to trigger animation
    void messageArea.offsetWidth;
    messageArea.classList.add('show');

    // Auto hide after 5 seconds
    setTimeout(() => {
      messageArea.classList.remove('show');
      // Wait for fade animation to complete before hiding
      setTimeout(() => {
        messageArea.style.display = 'none';
      }, 300); // Match transition duration
    }, 5000);
  }
</script>
<script> //Terms & Conditions Modal
  // Terms and conditions modal handling
  document.getElementById('acceptTerms').addEventListener('click', function () {
    // Check the checkbox
    document.getElementById('termsCheck').checked = true;

    // Close the modal
    const modal = bootstrap.Modal.getInstance(document.getElementById('termsModal'));
    modal.hide();
  });

  // Handle checkbox clicks
  document.getElementById('termsCheck').addEventListener('click', function (e) {
    if (this.checked) {
      // If trying to check the box, prevent default and show modal
      e.preventDefault();
      const modal = new bootstrap.Modal(document.getElementById('termsModal'));
      modal.show();
    }
    // Allow unchecking to proceed normally
  });

  // Reset checkbox when modal is dismissed without accepting
  document.getElementById('termsModal').addEventListener('hidden.bs.modal', function () {
    if (!document.getElementById('termsCheck').checked) {
      document.getElementById('termsCheck').checked = false;
    }
  });
</script>

<script> //Password
  // Password functionality
  document.addEventListener('DOMContentLoaded', () => {
    const passwordInput = document.getElementById('adminPassword');
    const requirements = document.getElementById('passwordRequirements');

    // Initially hide requirements
    requirements.style.display = 'none';

    // Toggle password visibility
    document.getElementById('togglePassword').addEventListener('click', function () {
      const icon = this.querySelector('i');

      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
      } else {
        passwordInput.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
      }
    });

    // Show requirements on focus and input
    passwordInput.addEventListener('focus', () => {
      requirements.style.display = 'block';
    });

    passwordInput.addEventListener('input', () => {
      requirements.style.display = 'block';
    });

    // Hide requirements only when leaving field and it's empty
    passwordInput.addEventListener('blur', () => {
      if (!passwordInput.value) {
        requirements.style.display = 'none';
      }
    });

    // Validation function
    function validatePassword(input) {
      const password = input.value;
      const requirements = {
        minLength: password.length >= 8,
        hasUpper: /[A-Z]/.test(password),
        hasLower: /[a-z]/.test(password),
        hasNumber: /\d/.test(password),
        hasSpecial: /[@$!%*?&]/.test(password)
      };

      // Update visual feedback for each requirement
      Object.keys(requirements).forEach(req => {
        const element = document.getElementById(req);
        const originalText = element.textContent.replace('✓ ', '');

        if (requirements[req]) {
          element.style.color = '#198754';
          element.textContent = `✓ ${originalText}`;
        } else {
          element.style.color = '#dc3545';
          element.textContent = originalText;
        }
      });

      input.setCustomValidity(
        Object.values(requirements).every(Boolean)
          ? ''
          : 'Please meet all password requirements'
      );
    }

    // Add input event listener for validation
    passwordInput.addEventListener('input', function () {
      validatePassword(this);
    });
  });
</script>
<script>
  // Add this JavaScript for real-time validation
  document.getElementById('adminEmail').addEventListener('input', function (e) {
    const email = e.target.value;
    const validDomains = ['@ceu.edu.ph', '@mls.ceu.edu.ph'];
    const isValid = validDomains.some(domain => email.toLowerCase().endsWith(domain));

    if (email && !isValid) {
      e.target.setCustomValidity('Please use your CEU email address');
      e.target.classList.add('is-invalid');
    } else {
      e.target.setCustomValidity('');
      e.target.classList.remove('is-invalid');
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const termsCheck = document.getElementById('termsCheck');
    const form = document.getElementById('adminSignupForm');

    // Set initial validation message
    termsCheck.setCustomValidity('Please accept the Terms and Conditions to proceed');

    // Handle checkbox changes
    termsCheck.addEventListener('change', function () {
      if (this.checked) {
        this.setCustomValidity(''); // Clear validation message
      } else {
        this.setCustomValidity('Please accept the Terms and Conditions to proceed');
      }
    });

    // Handle form submission
    form.addEventListener('submit', function (e) {
      if (!termsCheck.checked) {
        e.preventDefault();
        termsCheck.setCustomValidity('Please accept the Terms and Conditions to proceed');
        termsCheck.reportValidity();
      } else {
        termsCheck.setCustomValidity('');
      }
    });

    // Handle terms acceptance from modal
    document.getElementById('acceptTerms').addEventListener('click', function () {
      termsCheck.checked = true;
      termsCheck.setCustomValidity('');
      termsCheck.reportValidity();
    });
  });
</script>

</html>